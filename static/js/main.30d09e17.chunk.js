(this["webpackJsonpinsta-clone"]=this["webpackJsonpinsta-clone"]||[]).push([[0],{152:function(e,t,n){e.exports=n(209)},200:function(e,t,n){},209:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),i=n(16),l=n.n(i),o=n(23),c=n(247),u=n(248),s=n(139),m=n(125),d=n.n(m),g=n(245),p=Object(g.a)((function(e){return{title:{paddingLeft:e.spacing(2)}}}));var f=function(){var e=p();return(r.a.createElement(c.a,{position:"fixed",color:"primary"},r.a.createElement(u.a,null,r.a.createElement(d.a,null),r.a.createElement(s.a,{variant:"h6",component:"h1",className:e.title},"Apollo Music Share"))))},b=n(80),v=n(32),h=n(70),E=n.n(h),y=n(101),O=n(268),S=n(253),j=n(254),x=n(252),N=n(129),w=n.n(N),C=n(249),k=n(271),I=n(250),q=n(251),_=n(141),P=n(81),T=n.n(P),F=n(31),G=n(38),A=n(39);function Q(){var e=Object(G.a)(["\n    mutation AddSong(\n    $artist: String!, \n    $title: String!, \n    $duration: Float!,\n    $url: String!, \n    $thumbnail: String!\n) {\n  insert_songs(\n     objects: {\n         artist: $artist, \n         duration: $duration, \n         title: $title, \n         url: $url, \n         thumbnail: $thumbnail\n     }) {\n    affected_rows\n  }\n}\n"]);return Q=function(){return e},e}function $(){var e=Object(G.a)(["\n    mutation addOrRemoveFromQueue($input: SongInput!){\n        addOrRemoveFromQueue(input: $input) @client \n    }\n"]);return $=function(){return e},e}var D=Object(A.a)($()),R=Object(A.a)(Q()),B=Object(_.a)((function(e){return{container:{display:"flex",alignItems:"center"},urlInput:{margin:e.spacing(1)},addSongButton:{margin:e.spacing(1)},dialog:{textAline:"center"},thumbnail:{width:"90%"}}})),L={duration:0,title:"",artist:"",thumbnail:"",url:""};var M=function(){var e=Object(a.useState)(!1),t=Object(o.a)(e,2),n=t[0],i=t[1],l=Object(a.useState)(""),c=Object(o.a)(l,2),u=c[0],s=c[1],m=Object(a.useState)(!1),d=Object(o.a)(m,2),g=d[0],p=d[1],f=Object(a.useState)(L),h=Object(o.a)(f,2),N=h[0],_=h[1],P=Object(F.a)(R),G=Object(o.a)(P,2),A=G[0],Q=G[1].error,$=B(),D=function(){i(!1)},M=function(){var e=Object(y.a)(E.a.mark((function e(){var t,n,a,r,i;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=N.duration,n=N.title,a=N.artist,r=N.thumbnail,i=N.url,e.next=4,A({variables:{duration:t>0?t:null,title:n.length>0?n:null,artist:a.length>0?a:null,thumbnail:r.length>0?r:null,url:i.length>0?i:null}});case 4:_(L),D(),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.log("error",e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}();function J(){return(J=Object(y.a)(E.a.mark((function e(t){var n,a,r;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.player,p(!0),!(a=n.player.player).getVideoData){e.next=7;break}r=W(a),e.next=11;break;case 7:if(!a.getCurrentSound){e.next=11;break}return e.next=10,Y(a);case 10:r=e.sent;case 11:_(Object(v.a)({},r,{url:u}));case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var z=function(e){var t=e.target,n=t.name,a=t.value;_((function(e){return Object(v.a)({},e,Object(b.a)({},n,a))}))},W=function(e){var t=e.getDuration(),n=e.getVideoData(),a=n.title,r=n.video_id;return{duration:t,title:a,artist:n.author,thumbnail:"http://img.youtube.com/vi/".concat(r,"/0.jpg")}},Y=function(e){return new Promise((function(t){e.getCurrentSound((function(e){e&&t({duration:Number(e.duration/1e3),title:e.title,artist:e.user.username,thumbnail:e.artwork_url.replace("-large","-t500x500")})}))}))},U=function(e){var t,n;return null===Q||void 0===Q?void 0:null===(t=Q.graphQLErrors[0])||void 0===t?void 0:null===(n=t.extensions)||void 0===n?void 0:n.path.includes(e)},K=N.title,V=N.artist,H=N.thumbnail;return r.a.createElement("div",{className:$.container},r.a.createElement(k.a,{open:n,onClose:D,className:$.dialog},r.a.createElement(C.a,null,"Edit Song"),r.a.createElement(I.a,null,r.a.createElement("img",{src:H,alt:"Song thumbnail",className:$.thumbnail}),r.a.createElement(O.a,{value:K,margin:"dense",name:"title",label:"Title",onChange:z,fullWidth:!0,error:U("title"),helperText:U("title")&&"Fill out field"}),r.a.createElement(O.a,{value:V,margin:"dense",name:"artist",label:"Artist",onChange:z,fullWidth:!0,error:U("artist"),helperText:U("artist")&&"Fill out field"}),r.a.createElement(O.a,{value:H,margin:"dense",name:"thumbnail",label:"Thumbnail",onChange:z,fullWidth:!0,error:U("thumbnail"),helperText:U("thumbnail")&&"Fill out field"})),r.a.createElement(q.a,null,r.a.createElement(x.a,{color:"secondary",onClick:D},"Cancel"),r.a.createElement(x.a,{color:"primary",onClick:M,variant:"outlined"},"Add Song"))),r.a.createElement(O.a,{onChange:function(e){p(!1),s(e.target.value)},value:u,className:$.urlInput,placeholder:"Add your Youtube or SoundCloud url",fullWidth:!0,margin:"normal",type:"url",InputProps:{startAdornment:r.a.createElement(S.a,{position:"start"},r.a.createElement(w.a,null))}}),r.a.createElement(x.a,{onClick:function(){return i(!0)},disabled:!g,className:$.addSongButton,variant:"contained",color:"primary",endIcon:r.a.createElement(j.a,null)},"Add"),r.a.createElement(T.a,{url:u,hidden:!0,onReady:function(e){return function(e){return J.apply(this,arguments)}(e)}}))},J=n(260),z=n(255),W=n(256),Y=n(257),U=n(258),K=n(259),V=n(91),H=n.n(V),X=n(130),Z=n.n(X),ee=n(90),te=n.n(ee),ne=Object(g.a)((function(e){return{container:{margin:e.spacing(3)},songInfoContainer:{display:"flex",alignItems:"center"},songInfo:{width:"100%",display:"flex",justifyContent:"space-between"},thumbnail:{objectFit:"cover",width:140,height:140}}}));var ae=function(e){var t=e.song,n=Object(a.useState)(!1),i=Object(o.a)(n,2),l=i[0],c=i[1],u=t.thumbnail,m=t.title,d=t.artist,g=t.id,p=r.a.useContext(we),f=p.state,b=p.dispatch,h=ne(),E=Object(F.a)(D,{onCompleted:function(e){localStorage.setItem("queue",JSON.stringify(e.addOrRemoveFromQueue))}}),y=Object(o.a)(E,1)[0];Object(a.useEffect)((function(){var e=f.isPlaying&&g===f.song.id;c(e)}),[g,f.song.id,f.isPlaying]);var O=function(){b({type:"SET_SONG",song:t}),b(l?{type:"STOP_SONG"}:{type:"PLAY_SONG"})};return r.a.createElement(z.a,{className:h.container},r.a.createElement("div",{className:h.songInfoContainer},r.a.createElement(W.a,{image:u,className:h.thumbnail}),r.a.createElement("div",{className:h.songInfo},r.a.createElement(Y.a,null,r.a.createElement(s.a,{gutterBottom:!0,variant:"h5",component:"h2"},m),r.a.createElement(s.a,{gutterBottom:!0,variant:"body1",component:"p",color:"textSecondary"},d)),r.a.createElement(U.a,null,l?r.a.createElement(K.a,{onClick:O,size:"small",color:"primary"},r.a.createElement(te.a,null)):r.a.createElement(K.a,{onClick:O,size:"small",color:"primary"},r.a.createElement(H.a,null)),r.a.createElement(K.a,{size:"small",color:"secondary",onClick:function(){y({variables:{input:Object(v.a)({},t,{__typename:"Song"})}})}},r.a.createElement(Z.a,null))))))};function re(){var e=Object(G.a)(["\nsubscription GetSongs {\n  songs(order_by: {created_at: desc}) {\n    artist\n    duration\n    id\n    thumbnail\n    title\n    url\n  }\n}\n"]);return re=function(){return e},e}var ie=Object(A.a)(re());var le=function(){var e=Object(F.c)(ie),t=e.data,n=e.loading,a=e.error;return n?r.a.createElement("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",marginTop:50}},r.a.createElement(J.a,{color:"primary"})):a?r.a.createElement("div",null,"Error fetching songs"):r.a.createElement("div",null,t.songs.map((function(e){return r.a.createElement(ae,{key:e.id,song:e})})))},oe=n(132),ce=n.n(oe),ue=n(133),se=n.n(ue),me=n(273),de=n(272),ge=n(262),pe=n(131),fe=n.n(pe)()({avatar:{width:44,height:44},text:{textOverflow:"ellipsis",overflow:"hidden"},container:{display:"grid",gridAutoFlow:"column",gridTemplateColumns:"50px auto 50px",gridGap:12,alignItems:"center",marginTop:10},songInfoContainer:{overflow:"hidden",whiteSpace:"nowrap"}});var be=function(e){var t=e.song,n=fe(),a=t.thumbnail,i=t.artist,l=t.title,c=Object(F.a)(D,{onCompleted:function(e){localStorage.setItem("queue",JSON.stringify(e.addOrRemoveFromQueue))}}),u=Object(o.a)(c,1)[0];return r.a.createElement("div",{className:n.container},r.a.createElement(de.a,{src:a,alt:"Song thumbnail",className:n.avatar}),r.a.createElement("div",{className:n.songInfoContainer},r.a.createElement(s.a,{variant:"subtitle2",className:n.text},l),r.a.createElement(s.a,{variant:"body2",color:"textSecondary",className:n.text},i)),r.a.createElement(K.a,null,r.a.createElement(ge.a,{color:"error",onClick:function(){u({variables:{input:Object(v.a)({},t,{__typename:"Song"})}})}})))},ve=n(270);var he=function(e){var t=e.queue;return(r.a.createElement(ve.a,{mdDown:!0},r.a.createElement("div",{style:{margin:"10px 0"}},r.a.createElement(s.a,{color:"textSecondary",variant:"button"},"QUEUE(",t.length,")"),t.map((function(e,t){return r.a.createElement(be,{key:t,song:e})})))))};function Ee(){var e=Object(G.a)(["\n    query getQueueSongs {\n        queue @client{\n            id\n            duration\n            title\n            artist\n            thumbnail\n            url\n        }\n    }\n    "]);return Ee=function(){return e},e}var ye=Object(A.a)(Ee()),Oe=Object(g.a)((function(e){return{container:{display:"flex",justifyContent:"space-between"},details:{display:"flex",flexDirection:"column",padding:"0 15px"},content:{flex:"1 0 auto"},thumbnail:{width:150},controls:{display:"flex",alignItems:"center",paddingLeft:e.spacing(1),paddingRight:e.spacing(1)},playIcon:{height:38,width:38}}}));var Se=function(){var e=r.a.useContext(we),t=e.state,n=e.dispatch,i=Object(F.b)(ye).data,l=Object(a.useState)(0),c=Object(o.a)(l,2),u=c[0],m=c[1],d=Object(a.useState)(!1),g=Object(o.a)(d,2),p=g[0],f=g[1],b=Object(a.useState)(0),v=Object(o.a)(b,2),h=v[0],E=v[1],y=Object(a.useState)(0),O=Object(o.a)(y,2),S=O[0],j=O[1],x=Object(a.useRef)();Object(a.useEffect)((function(){var e=i.queue.findIndex((function(e){return e.id===t.song.id}));j(e)}),[t.song.id,i.queue]),Object(a.useEffect)((function(){var e=i.queue[S+1];u>=.99&&e&&(m(0),n({type:"SET_SONG",song:e}))}),[t.song.id,i.queue,u,n,S]);var N=Oe(),w=function(){n(t.isPlaying?{type:"STOP_SONG"}:{type:"PLAY_SONG"})};return r.a.createElement(r.a.Fragment,null,r.a.createElement(z.a,{variant:"outlined",className:N.container},r.a.createElement("div",{className:N.details},r.a.createElement(Y.a,{className:N.content},r.a.createElement(s.a,{variant:"h5",component:"h3"},t.song.title),r.a.createElement(s.a,{variant:"subtitle1",component:"p",color:"textSecondary"},t.song.artist)),r.a.createElement("div",{className:N.controls},r.a.createElement(K.a,{onClick:function(){var e=i.queue[S-1];e&&n({type:"SET_SONG",song:e})}},r.a.createElement(ce.a,null)),t.isPlaying?r.a.createElement(K.a,{onClick:w},r.a.createElement(te.a,{className:N.playIcon})):r.a.createElement(K.a,{onClick:w},r.a.createElement(H.a,{className:N.playIcon})),r.a.createElement(K.a,{onClick:function(){var e=i.queue[S+1];e&&n({type:"SET_SONG",song:e})}},r.a.createElement(se.a,null)),r.a.createElement(s.a,{variant:"subtitle1",component:"p",color:"textSecondary"},new Date(1e3*h).toISOString().substr(11,8))),r.a.createElement(me.a,{onMouseDown:function(){f(!0)},onMouseUp:function(){f(!1),x.current.seekTo(u)},onChange:function(e,t){m(t)},value:u,type:"range",min:0,max:1,step:.01})),r.a.createElement(T.a,{hidden:!0,url:t.song.url,playing:t.isPlaying,ref:x,onProgress:function(e){var t=e.played,n=e.playedSeconds;m(t),p||(m(t),E(n))}}),r.a.createElement(W.a,{className:N.thumbnail,image:t.song.thumbnail})),r.a.createElement(he,{queue:i.queue}))},je=n(264),xe=n(263);var Ne=function(e,t){switch(t.type){case"PLAY_SONG":return Object(v.a)({},e,{isPlaying:!0});case"STOP_SONG":return Object(v.a)({},e,{isPlaying:!1});case"SET_SONG":return Object(v.a)({},e,{song:t.song});default:return e}},we=(n(200),r.a.createContext({song:{id:"fd404e5d-ff64-4185-ad41-65a8e789efbc",title:"Klingande & Bright Sparks - Messiah",artist:"Klingande",url:"https://soundcloud.com/klingande/klingande-messiah",duration:184.283,thumbnail:"https://i1.sndcdn.com/artworks-000493591659-o4jzay-t500x500.jpg"},isPlaying:!1}));var Ce=function(){var e=r.a.useContext(we),t=r.a.useReducer(Ne,e),n=Object(o.a)(t,2),a=n[0],i=n[1],l=Object(xe.a)((function(e){return e.breakpoints.up("md")})),c=Object(xe.a)((function(e){return e.breakpoints.up("sm")}));return r.a.createElement(we.Provider,{value:{state:a,dispatch:i}},r.a.createElement(ve.a,{only:"xs"},r.a.createElement(f,null)),r.a.createElement(je.a,{container:!0,spacing:3},r.a.createElement(je.a,{item:!0,xs:12,md:7,style:{paddingTop:c?80:10}},r.a.createElement(M,null),r.a.createElement(le,null)),r.a.createElement(je.a,{item:!0,xs:12,md:5,style:l?{position:"fixed",width:"100%",right:0,top:70}:{position:"fixed",width:"100%",left:0,bottom:0}},r.a.createElement(Se,null))))},ke=n(261),Ie=n(135),qe=n(265),_e=n(266),Pe=Object(Ie.a)({palette:{type:"dark",primary:qe.a,secondary:_e.a}}),Te=n(267),Fe=n(136),Ge=n(30),Ae=n(134),Qe=n(49);function $e(){var e=Object(G.a)(["\n        type Song {\n        id: uuid!\n        title: String!\n        artist: String!\n        thumbnail: String!\n        duration: String!\n        url: String!\n        }\n        input SongInput {\n            id: uuid!\n            title: String!\n            artist: String!\n            thumbnail: String!\n            duration: String!\n            url: String!\n        }\n        type Query{\n            queue: [Song]!\n        }\n        type Mutation {\n            addOrRemoveFromQue(input: SongInput): [Song]!\n        }\n    "]);return $e=function(){return e},e}var De=new Ge.c({link:new Ae.a({uri:"wss://react-music-appp.herokuapp.com/v1/graphql",options:{reconnect:!0}}),cache:new Qe.a,typeDefs:Object(A.a)($e()),resolvers:{Mutation:{addOrRemoveFromQueue:function(e,t,n){var a=t.input,r=n.cache,i=r.readQuery({query:ye});if(i){var l=i.queue,o=l.some((function(e){return e.id===a.id}))?l.filter((function(e){return e.id!==a.id})):[].concat(Object(Fe.a)(l),[a]);return r.writeQuery({query:ye,data:{queue:o}}),o}return[]}}}}),Re={queue:Boolean(localStorage.getItem("queue"))?JSON.parse(localStorage.getItem("queue")):[]};De.writeData({data:Re});var Be=De,Le=n(27);l.a.render(r.a.createElement(Le.a,{client:Be},r.a.createElement(ke.a,{theme:Pe},r.a.createElement(Te.a,null),r.a.createElement(Ce,null))),document.getElementById("root"))}},[[152,1,2]]]);
//# sourceMappingURL=main.30d09e17.chunk.js.map